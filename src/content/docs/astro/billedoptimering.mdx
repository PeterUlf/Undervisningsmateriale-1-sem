---
title: Astro â€“ Billedoptimering
description: LÃ¦r hvordan Astros indbyggede billedoptimering virker og hvordan du bruger Image-komponenten.
sidebar:
  label: "Astro â€“Billedoptimering"
  order: 9
  badge:
    text: Tema 7
    variant: tip
    class: badge-theme-7
---

import Slide from "../../../components/Slide.astro";

<Slide>

## Den nemme lÃ¸sning â€“ Billeder fra `public`-mappen

:::note[God nyhed for begyndere]
Denne metode minder meget om det, du kender i forvejen fra almindelig HTML. Det er helt fint at bruge denne tilgang, nÃ¥r du er ved at komme i gang med Astro.

**Men**: LÃ¦ngere nede i dokumentet lÃ¦rer du den rigtigste lÃ¸sning â€“ Astros `<Image>`-komponent â€“ som giver dig meget bedre performance og billedoptimering.
:::

Hvis du bare vil have et billede til at virke hurtigt uden optimering, kan du lÃ¦gge det i `public`-mappen og bruge en almindelig `<img>`-tag.

### SÃ¥dan gÃ¸r du:

1. **LÃ¦g billedet i `public`-mappen:**

   ```text
   public/
     billeder/
       mit-foto.jpg
   ```

2. **Brug en almindelig `<img>`-tag:**

   ```html
   <img src="/billeder/mit-foto.jpg" alt="Mit foto" />
   ```

:::caution[Vigtigt]
Stien starter med `/` fordi `public`-mappen bliver til roden af dit website.
:::

**Dette er nemt, men...**

- âŒ Ingen automatisk komprimering
- âŒ Ingen formatkonvertering (WebP)
- âŒ Ingen responsive images
- âŒ Ikke optimeret for forskellige skÃ¦rmstÃ¸rrelser

**Brug derfor kun denne metode til:**

- SmÃ¥ ikoner eller simple grafiske elementer
- NÃ¥r du hurtigt skal teste noget
- NÃ¥r billedoptimering ikke er nÃ¸dvendig

For bedre performance, lÃ¦s videre om Astros `<Image>`-komponent! ğŸ‘‡

</Slide>

---

## TL;DR (Til dem der ved hvad de laver)

Brug Astros `Image`-komponent til automatisk billedoptimering:

```astro
---
import { Image } from 'astro:assets';
import minBillede from '../assets/foto.jpg';
---

<!-- Optimeret billede -->
<Image src={minBillede} alt="Beskrivelse" />

<!-- Med tilpassede dimensioner -->
<Image src={minBillede} alt="Beskrivelse" width={800} height={600} />
```

**Fordele:**

- Automatisk komprimering og formatkonvertering (WebP)
- Responsive images med `srcset`
- Lazy loading som standard
- Bevarer billedkvalitet mens filstÃ¸rrelsen mindskes

---

<Slide>

## Hvorfor billedoptimering?

Billeder er ofte den tungeste del af en hjemmeside. **Uoptimerede billeder** kan:

- ğŸŒ GÃ¸re siden langsom at loade
- ğŸ“± Bruge unÃ¸dvendigt meget data pÃ¥ mobil
- ğŸ˜ Give dÃ¥rlig brugeroplevelse
- ğŸ“‰ Skade din SEO-ranking

**Astro lÃ¸ser dette automatisk** med indbygget billedoptimering!

:::tip[Fun fact]
Et 5MB-billede kan ofte komprimeres til under 200KB uden synligt kvalitetstab!
:::

</Slide>

---

<Slide>

## Almindelig `<img>` vs Astros `<Image>`

### âŒ Almindelig `<img>` tag (ingen optimering)

```html
<img src="/billeder/foto.jpg" alt="Foto" />
```

**Problemer:**

- Ingen komprimering
- Ingen formatkonvertering
- Samme billede til alle skÃ¦rmstÃ¸rrelser
- Ingen lazy loading som standard

### âœ… Astros `<Image>` komponent (fuld optimering)

```astro
---
import { Image } from 'astro:assets';
import foto from '../assets/foto.jpg';
---

<Image src={foto} alt="Foto" />
```

**Fordele:**

- Automatisk WebP/AVIF konvertering
- Responsive images (flere stÃ¸rrelser)
- Lazy loading indbygget
- Optimeret kvalitet vs. filstÃ¸rrelse

</Slide>

---

<Slide>

## Installation og setup

### 1. Image-komponenten er indbygget

Du behÃ¸ver ikke at installere noget! `Image`-komponenten fÃ¸lger med Astro:

```astro
---
import { Image } from 'astro:assets';
---
```

### 2. Organiser dine billeder

LÃ¦g billeder i `src/assets/` for at de kan optimeres:

```text
src/
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ logo.png
â”‚   â”œâ”€â”€ hero.jpg
â”‚   â””â”€â”€ produkter/
â”‚       â”œâ”€â”€ produkt-1.jpg
â”‚       â””â”€â”€ produkt-2.jpg
â””â”€â”€ pages/
    â””â”€â”€ index.astro
```

:::note[Vigtigt]
Billeder i `public/`-mappen optimeres **ikke** automatisk. Brug `src/assets/` til billeder der skal optimeres.
:::

</Slide>

---

<Slide>

## GrundlÃ¦ggende brug

### Import og brug billede

```astro
---
import { Image } from 'astro:assets';
import heroImage from '../assets/hero.jpg';
---

<Image
  src={heroImage}
  alt="Vores fantastiske produkt"
/>
```

Astro gÃ¸r automatisk:

- âœ… Komprimerer billedet
- âœ… Konverterer til WebP (hvis browseren understÃ¸tter det)
- âœ… Opretter flere stÃ¸rrelser til responsive images
- âœ… TilfÃ¸jer lazy loading

</Slide>

---

<Slide>

## Specificer dimensioner

### Med bredde og hÃ¸jde

```astro
---
import { Image } from 'astro:assets';
import produkt from '../assets/produkt.jpg';
---

<Image
  src={produkt}
  alt="Produkt"
  width={800}
  height={600}
/>
```

### Kun bredde (hÃ¸jde skaleres proportionelt)

```astro
<Image
  src={produkt}
  alt="Produkt"
  width={400}
/>
```

:::tip[Best practice]
Angiv altid `width` og `height` for at undgÃ¥ layout shift nÃ¥r siden loader!
:::

</Slide>

---

<Slide>

## Billedkvalitet

Kontroller komprimeringsgraden med `quality`-parameteren (1-100):

```astro
---
import { Image } from 'astro:assets';
import highRes from '../assets/high-res.jpg';
---

<!-- Lav kvalitet, mindre filstÃ¸rrelse (god til thumbnails) -->
<Image src={highRes} alt="Thumbnail" width={200} quality={60} />

<!-- Standard kvalitet (default: 80) -->
<Image src={highRes} alt="Normal" width={800} />

<!-- HÃ¸j kvalitet, stÃ¸rre filstÃ¸rrelse -->
<Image src={highRes} alt="High quality" width={1200} quality={95} />
```

:::note[Standard]
Hvis du ikke angiver `quality`, bruges 80 som standard â€“ et godt kompromis mellem kvalitet og filstÃ¸rrelse.
:::

</Slide>

---

<Slide>

## Billedformater

Astro konverterer automatisk til moderne formater:

### Automatisk formatvalg

```astro
<Image src={foto} alt="Foto" />
```

Astro vÃ¦lger det bedste format baseret pÃ¥:

- Browserens understÃ¸ttelse (WebP, AVIF)
- Billedtype (foto vs. grafik)
- FilstÃ¸rrelse

### Specifikt format

```astro
<Image src={foto} alt="Foto" format="webp" />
<Image src={logo} alt="Logo" format="png" />
```

**TilgÃ¦ngelige formater:**

- `webp` â€“ Moderne, effektivt (anbefalet til fotos)
- `avif` â€“ Endnu bedre komprimering (nyere browsere)
- `png` â€“ Til billeder med gennemsigtighed
- `jpg`/`jpeg` â€“ Klassisk format

</Slide>

---

<Slide>

## Remote (eksterne) billeder

Du kan ogsÃ¥ optimere billeder fra eksterne URLs:

```astro
---
import { Image } from 'astro:assets';
---

<Image
  src="https://example.com/remote-image.jpg"
  alt="Eksternt billede"
  width={800}
  height={600}
  inferSize
/>
```

:::caution[Krav til remote images]
Du skal tilfÃ¸je domÃ¦net til `image.domains` i `astro.config.mjs`:

```js
export default defineConfig({
  image: {
    domains: ["example.com", "images.unsplash.com"],
  },
});
```

:::

</Slide>

---

<Slide>

## Responsive images

Astro genererer automatisk multiple stÃ¸rrelser:

```astro
---
import { Image } from 'astro:assets';
import responsive from '../assets/hero.jpg';
---

<Image
  src={responsive}
  alt="Hero"
  widths={[400, 800, 1200]}
  sizes="(max-width: 600px) 400px, (max-width: 1200px) 800px, 1200px"
/>
```

**Hvad sker der?**

- Astro opretter 3 versioner: 400px, 800px og 1200px
- Browseren vÃ¦lger den rigtige stÃ¸rrelse baseret pÃ¥ skÃ¦rmstÃ¸rrelse
- Sparer bÃ¥ndbredde pÃ¥ mobile enheder

</Slide>

---

<Slide>

## Lazy loading

Lazy loading er aktiveret som standard:

```astro
<!-- Lazy loads automatisk -->
<Image src={billede} alt="Billede" />

<!-- Disable lazy loading -->
<Image src={billede} alt="Above the fold" loading="eager" />
```

**Lazy loading betyder:**

- Billeder loader kun nÃ¥r de er synlige i viewporten
- Hurtigere initial page load
- Mindre data-forbrug

:::tip[Above the fold]
Brug `loading="eager"` til billeder der er synlige ved fÃ¸rste page load (hero-billeder).
:::

</Slide>

---

<Slide>

## Praktisk eksempel: Produktgalleri

```astro
---
import { Image } from 'astro:assets';
import produkt1 from '../assets/produkter/produkt-1.jpg';
import produkt2 from '../assets/produkter/produkt-2.jpg';
import produkt3 from '../assets/produkter/produkt-3.jpg';

const produkter = [
  { billede: produkt1, navn: "Produkt 1", pris: "299 kr" },
  { billede: produkt2, navn: "Produkt 2", pris: "399 kr" },
  { billede: produkt3, navn: "Produkt 3", pris: "499 kr" },
];
---

<div class="product-grid">
  {produkter.map(produkt => (
    <div class="product-card">
      <Image
        src={produkt.billede}
        alt={produkt.navn}
        width={400}
        height={400}
        quality={85}
      />
      <h3>{produkt.navn}</h3>
      <p>{produkt.pris}</p>
    </div>
  ))}
</div>

<style>
  .product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .product-card img {
    width: 100%;
    height: auto;
    border-radius: 8px;
  }
</style>
```

</Slide>

---

<Slide>

## Dynamiske billeder fra Collections

NÃ¥r du henter billeder fra Content Collections:

```astro
---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
---

{posts.map(post => (
  <article>
    <Image
      src={post.data.coverImage}
      alt={post.data.title}
      width={800}
      height={450}
    />
    <h2>{post.data.title}</h2>
  </article>
))}
```

**Content Collection schema:**

```ts
// src/content/config.ts
import { defineCollection, z } from "astro:content";

const blog = defineCollection({
  schema: ({ image }) =>
    z.object({
      title: z.string(),
      coverImage: image(),
    }),
});
```

</Slide>

---

<Slide>

## Picture-komponenten for avanceret kontrol

Brug `Picture` nÃ¥r du vil have fuld kontrol over art direction:

```astro
---
import { Picture } from 'astro:assets';
import mobile from '../assets/hero-mobile.jpg';
import desktop from '../assets/hero-desktop.jpg';
---

<Picture
  src={desktop}
  alt="Hero"
  widths={[400, 800, 1200]}
  formats={['webp', 'jpg']}
  breakpoints={{
    mobile: { src: mobile, media: '(max-width: 768px)' },
    desktop: { src: desktop, media: '(min-width: 769px)' }
  }}
/>
```

**Use cases:**

- Forskellige billedudsnit til mobile vs. desktop
- Portrait vs. landscape orientering
- Fokus pÃ¥ forskellige dele af billedet

</Slide>

---

<Slide>

## Background images med optimering

Du kan ikke bruge `Image` direkte i CSS, men du kan gÃ¸re det sÃ¥dan:

```astro
---
import { Image } from 'astro:assets';
import bgImage from '../assets/background.jpg';
import { getImage } from 'astro:assets';

const optimizedBg = await getImage({ src: bgImage });
---

<section style={`background-image: url(${optimizedBg.src})`}>
  <h1>Indhold</h1>
</section>

<style>
  section {
    background-size: cover;
    background-position: center;
    min-height: 400px;
  }
</style>
```

</Slide>

---

<Slide>

## Ofte brugte parametre

Her er en komplet oversigt:

```astro
<Image
  src={billede}              // Billede-reference (required)
  alt="Beskrivelse"          // Alt-tekst (required)
  width={800}                // Bredde i pixels
  height={600}               // HÃ¸jde i pixels
  quality={85}               // Kvalitet 1-100 (default: 80)
  format="webp"              // Format: webp, avif, png, jpg
  loading="lazy"             // lazy | eager (default: lazy)
  decoding="async"           // async | sync | auto
  class="my-image"           // CSS-klasse
  inferSize                  // Automatisk stÃ¸rrelse for remote images
/>
```

</Slide>

---

<Slide>

## Performance-metrics

SÃ¥ meget kan du spare med billedoptimering:

### FÃ¸r optimering

```text
Original JPEG:
- FilstÃ¸rrelse: 4.2 MB
- Loadtid: ~8 sekunder (mobil 3G)
- Layout shift: âš ï¸  Ja (ingen dimensioner)
```

### Efter optimering med Astros Image

```text
Optimeret WebP:
- FilstÃ¸rrelse: 180 KB (96% mindre!)
- Loadtid: ~0.3 sekunder (mobil 3G)
- Layout shift: âœ… Nej (width/height defineret)
- Responsive: âœ… 3 forskellige stÃ¸rrelser
```

**Resultat:** ğŸ“ˆ Hurtigere side, bedre SEO, gladere brugere!

</Slide>

---

<Slide>

## Almindelige fejl og lÃ¸sninger

### âŒ Fejl: "Image not found"

```astro
<Image src="/assets/foto.jpg" alt="Foto" />
```

**Problem:** Du kan ikke bruge en sti som string med `Image`.

**LÃ¸sning:** Import billedet fÃ¸rst

```astro
---
import foto from '../assets/foto.jpg';
---
<Image src={foto} alt="Foto" />
```

---

### âŒ Fejl: Billede i `public/` optimeres ikke

```astro
import billede from '../../public/foto.jpg'; // âŒ Virker ikke
```

**LÃ¸sning:** Flyt billedet til `src/assets/`

```text
src/assets/foto.jpg  âœ…
```

</Slide>

---

<Slide>

## Tip: Hvor skal billeder placeres?

### `src/assets/` â€“ Til optimering âœ…

Brug til:

- Fotos og produktbilleder
- Hero-billeder
- Content-billeder
- Alt der skal optimeres

```astro
import { Image } from 'astro:assets';
import foto from '../assets/foto.jpg';
```

---

### `public/` â€“ Til direkte adgang ğŸ”§

Brug til:

- Favicon
- robots.txt, sitemap.xml
- PDF-filer
- Videoer
- Filer der skal have samme URL

```html
<img src="/favicon.svg" alt="Logo" /> <a href="/brochure.pdf">Download</a>
```

</Slide>

---

<Slide>

## Konfiguration i astro.config.mjs

Tilpas billedoptimering globalt:

```js
// astro.config.mjs
import { defineConfig } from "astro/config";

export default defineConfig({
  image: {
    // Tillad eksterne domÃ¦ner
    domains: ["images.unsplash.com", "cdn.example.com"],

    // Remote patterns (regex)
    remotePatterns: [
      {
        protocol: "https",
        hostname: "**.amazonaws.com",
      },
    ],

    // Standard service (sharp eller squoosh)
    service: {
      entrypoint: "astro/assets/services/sharp",
    },
  },
});
```

</Slide>

---

<Slide>

## Sharp vs Squoosh

Astro bruger en af to billedprocessorer:

### Sharp (anbefalet)

```bash
npm install sharp
```

**Fordele:**

- âš¡ Hurtigere
- ğŸ¨ Bedre kvalitet
- ğŸ”§ Flere features

### Squoosh (backup)

Indbygget fallback hvis Sharp ikke er installeret.

**Fordele:**

- ğŸ“¦ Ingen ekstra installation
- ğŸŒ Virker i alle miljÃ¸er

:::tip[Anbefaling]
Installer Sharp for bedre performance: `npm install sharp`
:::

</Slide>

---

<Slide>

## Best practices

### âœ… GÃ¸r dette:

- Import billeder fra `src/assets/` og brug `Image`-komponenten
- Angiv altid `width` og `height` for at undgÃ¥ layout shift
- Brug `loading="eager"` til above-the-fold billeder
- Komprimer kildebilleder fÃ¸r upload (men ikke for meget!)
- Brug meningsfuld alt-tekst til tilgÃ¦ngelighed

### âŒ UndgÃ¥ dette:

- Bruge almindelig `<img>` til billeder der kunne optimeres
- LÃ¦gge store billeder i `public/`-mappen
- Uploade 10MB-billeder uden at resize dem fÃ¸rst
- Glemme alt-tekst
- Bruge for lav kvalitet (under 60)

</Slide>

---

<Slide>

## Ã˜velse: Optimer et galleri

Lav et billede-galleri med optimering:

**Opgave:**

1. Opret 4-6 billeder i `src/assets/galleri/`
2. Import dem i en side
3. Vis dem i et responsive grid
4. Brug forskellige `quality`-vÃ¦rdier
5. TilfÃ¸j lazy loading

<details>
<summary>Se lÃ¸sning</summary>

```astro
---
import { Image } from 'astro:assets';
import img1 from '../assets/galleri/foto1.jpg';
import img2 from '../assets/galleri/foto2.jpg';
import img3 from '../assets/galleri/foto3.jpg';

const billeder = [
  { src: img1, alt: "Solnedgang" },
  { src: img2, alt: "Bjerg" },
  { src: img3, alt: "Strand" },
];
---

<div class="galleri">
  {billeder.map(billede => (
    <Image
      src={billede.src}
      alt={billede.alt}
      width={400}
      height={300}
      quality={85}
      loading="lazy"
    />
  ))}
</div>

<style>
  .galleri {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1rem;
  }
</style>
```

</details>

</Slide>

---

<Slide>

## Ressourcer og videre lÃ¦ring

- ğŸ“š [Astro Images Docs](https://docs.astro.build/en/guides/images/)
- ğŸ–¼ï¸ [Web.dev: Image optimization](https://web.dev/fast/#optimize-your-images)
- ğŸ¨ [Sharp documentation](https://sharp.pixelplumbing.com/)
- ğŸ“Š [WebP vs JPEG comparison](https://developers.google.com/speed/webp/docs/webp_study)

:::tip[Protip]
Brug Chrome DevTools' Network tab til at se hvor meget du sparer pÃ¥ billedoptimering!
:::

</Slide>

---

<Slide>

## Opsummering

- **Brug `Image`-komponenten** fra `astro:assets` til automatisk optimering
- **LÃ¦g billeder i `src/assets/`** for at de kan optimeres
- **Angiv width og height** for at undgÃ¥ layout shift
- **WebP/AVIF** genereres automatisk for bedre komprimering
- **Lazy loading** er standard for bedre performance
- **Responsive images** oprettes automatisk
- **kvalitet=80** er en god standard, juster efter behov

:::tip[Husk]
Billedoptimering er en af de nemmeste mÃ¥der at forbedre din hjemmesides performance og brugeroplevelse! ğŸš€
:::

</Slide>

<div class="page-break"></div>

<Slide>

## NÃ¦ste skridt

FortsÃ¦t i rÃ¦kken:

[GÃ¥ til Placeholder-billeder med via.assets.so â†’](/astro/placeholder-billeder/)

</Slide>
